# Log设计

## 关于log本身

### 日志级别

 |error|发生了严重的错误，必须马上处理。这种级别的错误是任何系统无法容忍的。如：空指针异常、数据库不可用、关键路径的用例无法继续执行|
|---|---|
 |warn |还会继续执行后面的流程，但是应该引起重视|
 |debug| 开发人员关注的事件|
 |trace|更为详尽的信息，只是开发阶段使用。在产品上线之后的一小段事件内你可能还需要关注下这些信息，不过这些日志记录只是临时性的，最终应该关掉。debug和trace的区别很难区分，不过如果你加了一行日志，开发测试完成后又删除了的话，这条日志就应该是trace级别的|

### 清楚自己在记录什么

写下一行日志语句后，花点时间看看你到底在日志文件里打印了些什么，找出异常的地方。至少要避免空指针异常。

### 描述要清晰

避免使用“魔法日志”,日志信息所记录的数据要有明确描述。

### 适当的格式

日志格式是很有用的工具，无形中为日志添加有价值的上下文信息。理想的日志格式应当包括：当前时间，日志级别，县城名，简单的日志名称，函数名，参数，返回值，行号等。

## 打log策略

## 业务相关

结合业务，目前现在项目的以下部分添加log

p0业务：

- story合成失败率
- 短视频合成失败率
- story上传失败率
- 短视频上传失败率
- story播放失败率
- 短视频播放失败率
- story播放首帧时长
- 短视频播放首帧时长
- 短视频下载失败率

主路径、拍摄路径：

- 启动、前后台切换相关
- 列表类的

     1. 一次刷新的耗时、端监控的点复制到log）
     2. 接口的状态码、耗时
     3. 加载失败
     4. 返回数据为空情况

- 视频播放

    1. 空白
    2. 播放失败（包括播放器内部的执行log）
    3. 异常（卡死、画面不动但有声音...）
   
- 用户对视频的操作

    1. 点击关注、喜欢时UI和接口的状态
    2. 评论

- UI展示

    1. Tab bar 消失
    2. 关键控件的状态
    3. viewWillAppear, viewWillDisappear等
    
## 参考
- [深入理解log机制](http://feihu.me/blog/2014/insight-into-log/)
- [如何打好一手log](http://www.cnblogs.com/luguo3000/p/3543487.html)
